<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>メインメニュー</title>

  <!-- Bootstrap 5 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- FontAwesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
  />

  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js" defer></script>

  <!-- Vue Dialog（404 修正版） -->
  <script src="https://unpkg.com/vue3-dialog@latest/dist/vue3-dialog.min.js" defer></script>
  <link rel="stylesheet" href="https://unpkg.com/vue3-dialog@latest/dist/vue3-dialog.css">

  <!-- Firebase SDK（必ず defer を付ける） -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js" defer></script>

  <style>
    /* スマホ〜PCまで自然に伸びるレスポンシブ調整 */
    #app {
      max-width: 900px;
      margin: auto;
      padding: 1rem;
    }

    .menu-button {
      padding: 1.2rem;
      font-size: 1.1rem;
    }

    @media (min-width: 768px) {
      .menu-button {
        padding: 1.5rem;
        font-size: 1.2rem;
      }
    }

    @media (min-width: 992px) {
      .menu-button {
        padding: 1.8rem;
        font-size: 1.3rem;
      }
    }
  </style>
</head>

<body>
  <main role="main">
    <div id="app" class="container">

      <!-- ローディング -->
      <div v-if="loading" class="text-center mt-5">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="mt-3">ユーザー情報を取得しています...</p>
      </div>

      <!-- メイン -->
      <div v-else>

        <!-- 上部ユーザー情報バー -->
        <div class="row bg-light mt-3 p-3 align-items-center rounded shadow-sm">

          <div class="col-8">
            <p class="mb-0">
              <strong>{{ username }}</strong><br>
              {{ userEmail }}（{{ userGroup }}）
            </p>
          </div>

          <div class="col-4 d-flex justify-content-end">
            <button class="btn btn-link text-danger" @click="logout">
              <i class="fas fa-2x fa-door-open"></i><br>終了
            </button>
          </div>
        </div>

        <br>

        <!-- タイトル -->
        <div class="text-center mb-4">
          <h2><i class="fas fa-home"></i> ホーム</h2>
        </div>

        <!-- メニュー -->
        <div class="row">
          <div class="col-12 col-md-10 col-lg-8 mx-auto">

            <button
              v-if="userrole >= 1100"
              class="btn btn-info col-12 mb-3 menu-button"
              @click="go('cardlist')"
            >
              <i class="fas fa-2x fa-tasks"></i>
              <h6>区域リスト</h6>
            </button>

            <button
              v-if="userrole >= 1010"
              class="btn btn-info col-12 mb-3 menu-button"
              @click="go('childlist')"
            >
              <i class="fas fa-2x fa-users"></i>
              <h6>グループページ</h6>
            </button>

            <button
              class="btn btn-primary col-12 mb-3 menu-button"
              @click="go('AssignmentList')"
            >
              <i class="fas fa-2x fa-street-view"></i>
              <h6>マイページ</h6>
            </button>

            <button
              v-if="userrole >= 1001"
              class="btn btn-light col-12 mb-3 menu-button"
              @click="go('settings')"
            >
              <i class="fas fa-2x fa-tools"></i>
              <h6>設定</h6>
            </button>

            <button
              v-if="userrole >= 9001"
              class="btn btn-light col-12 mb-3 menu-button"
              @click="go('admin')"
            >
              <i class="fas fa-2x fa-user-cog"></i>
              <h6>管理者設定</h6>
            </button>

          </div>
        </div>

        <br>

        <!-- お知らせ -->
        <div class="row">
          <div class="col-12 col-md-10 col-lg-8 mx-auto">
            <h5><b>お知らせ</b></h5>
            <h6><b>2023/04/05</b></h6>

            <p class="text-danger"><b>マイページの貸出中カードに残件数を表示するよう変更しました。</b></p>
            <p>・一旦、全ての住戸の件数が表示されています。</p>
            <p class="text-primary"><b>・カードを開いて表示すると件数が更新されます。</b></p>
            <p>・残件数とは、訪問済や留守宅、訪問拒否を除いた、訪問可能な件数です。</p>
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- mainMenu.js は module を外して defer -->
  <script src="mainMenu.js" defer></script>
</body>
</html>